#####################################################################################################################
####################################### Video Stream Loop Template ##################################################
#####################################################################################################################
import numpy as np
import cv2
import time

########################################### Video Stream Loop #######################################################
#####################################################################################################################

# Load Video:
video_path = 'video.mp4'
cap = cv2.VideoCapture(video_path)
video_fps = cap.get(cv2.CAP_PROP_FPS)
frame_res = (600,500)

while True:
    
    # Get Frame:
    start = time.time()
    success, frame = cap.read()
    
    if not success:
        print('Server OFF')
        break
        
    frame = cv2.resize(frame, frame_res)
    
    ###############################################################################################################
    ############################################# Processing ######################################################
    ###############################################################################################################
    
    ###############################################################################################################
    # Display FPS:
    end = time.time()

    frame_time = (end - start) + 0.0001
    fps = np.floor(1/frame_time)
        
    if (fps > video_fps):
        time.sleep(1/video_fps)
        fps = video_fps
            
    cv2.putText(frame, "FPS: {}".format(fps), (30,20), cv2.FONT_HERSHEY_SIMPLEX, 0.5, (0, 0, 255), 2)
    ###############################################################################################################
    # Keyboard Controls:
    key = cv2.waitKey(1) or 0xff   
    if key == ord('k'):
        break
    ###############################################################################################################
    # Show Frame:
    cv2.imshow("Video Stream", frame)
    ###############################################################################################################
    
cv2.destroyAllWindows()
cap.release()




